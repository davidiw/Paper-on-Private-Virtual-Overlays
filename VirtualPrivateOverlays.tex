\documentclass[conference]{IEEEtran}
\usepackage[dvips]{graphicx}
\graphicspath{{figs/}}
\usepackage[cmex10]{amsmath}
\usepackage{url}

\usepackage{multirow}
\usepackage{array}
\usepackage{footnote}

\widowpenalty=10000
\clubpenalty=10000

\begin{document}
\title{Reflection, Rendezvous, and Relaying: \\
Addressing the P2P Boostrap Problem for Small Overlay Networks}

\author{
%\IEEEauthorblockN{David Isaac Wolinsky, P. Oscar Boykin, and Renato Figueiredo}
%\IEEEauthorblockA{Advanced Computing Information Systems Lab\\
%University of Florida}
}

\maketitle

\begin{abstract}

Peer-to-Peer (P2P) overlays provide a framework for building distributed
applications consisting of few to many resources with features including
self-configuration, scalability, and resilience to node failures.  Such systems
have been successfully adopted in large-scale Internet services such as content
delivery networks, file sharing, and data storage.  The bootstrap problem,
finding an existing peer in the overlay, remains a challenge to enabling these
services for small-scale P2P systems.  In large networks, the bootstrap problem
has been solved by dedicated services, though creating and maintaining these
systems requires expertise and resources, which constrain their usefulness and
make them unappealing for small-scale systems.  Decentralized, P2P systems can
be useful in small-scale systems for privacy concerns as well as supporting
applications that lack dedicated, centralized bootstrap servers.

In this paper, we identify how existing services or overlays can be used to
solve the bootstrap problem.  The components of the framework are a method for
reflection methods for obtaining a publicly reachable address, so remote peers
can initiate sessions; rendezvous service for discovering remote peers, when
the overlay lacks stable membership; and a communication relay to exchange
connection information.  We have implemented a prototype of this system using
XMPP overlays, such as Google Talk and Live Journal Talk, and Brunet, a
structured overlay based upon Symphony.  We present a qualitative overview of
our prototype, quantitative evaluation of the prototype using simulation, and
experiences from deployment.  Uniquely differentiating our approach from
similar techniques, we have implemented this system and verified its usefulness
by deploying it on PlanetLab.

\end{abstract}

\section{Introduction}

While P2P overlays provide a scalable, resilient, and self-configuring platform
for distributed applications, their adoption rate for use across the Internet
has been slow outside of large-scale systems, such as data distribution and
communication.  General use of decentralized, P2P applications targeting homes
and small/medium businesses (SMBs) has been limited in large part due to
difficulty in decentralized discovery of P2P systems, the bootstrap problem,
further inhibited by constrained network conditions due to firewalls and NATs
(network address translators).  While these environments could benefit from
P2P, many of these users lack the resources or expertise necessary to bootstrap
private P2P overlays particularly when the member state is unsteady and across
wide-area network environments where a significant amount of or all peers may
be unable to initiate direct communication with each other due to firewalls and
NATs.

Examples of large-scale P2P systems include Skype, BitTorrent, and Gnutella.
Skype is a voice over P2P system, whereas BitTorrent and Gnutella are file
sharing programs.  Bootstrapping in these system follows a common pattern: the
overlay maintainers setup high availability systems for bootstrapping and
bundle their connection information with the application for distribution.
Upon starting the application, it queries these high availability peers and
connects to other peers in the system.  Alternatively, some services constantly
crawl the network and place peer lists on dedicated web sites, a new peer
wishing to join the network queries the web site and then attempts to connect
to the peers on that list.

In smaller-scale systems, interest in P2P focuses more on the decentralized
component.  Users may desire to run an application at many distributed sites,
but the application lacks dedicated central servers to provide discovery or
rendezvous service for peers.  Alternatively, dedicated, centralized P2P
service providers, such as LogMeIn's Hamachi, a P2P VPN, may collect usage
data, which the users may wish to remain private.  Many applications fit into
these roles, such as multiplayer games, especially those that never or no
longer have dedicated online services; private data sharing; or even
distributed file systems.  Clearly, a small P2P system could be bootstrapped by
one or more users of the system running on public IP addresses, exchanging
those addresses through e-mail or phone, and then bootstrapping from there, but
but these types of situations are an exception and not the norm.  Instead, We
focus on the components that can make decentralized bootstrapping transparent
to the user, so that user interaction with the P2P component of the application
is minimal and intuitive.

The basic bootstrapping process can be broken down into two components finding a
remote peer and then successively connecting to more peers.  When a node
bootstraps into a P2P system, it contacts bootstrap servers, until it
successfully connects with one.  Upon connecting with a bootstrap server, the
two exchange information.  The bootstrap server may inquire into the overlay for
the best set of peers for the new peer and respond with that information or it
may respond with its existing neighbors.  At which point, the peer attempts to
connect with those peers.  This process continues aggressively until the peer
arrives at the location in the overlay, where they belong.  Afterward, the P2P
logic arrives at a steady state and only reacts based upon churn, that is new
incoming peers or outgoing peers.

Overlays with support for constrained peers, those behind NATs and firewalls,
require a few more components.  Before that, let us investigate why a peer may
want to connect to a peer behind a NAT rather than communicate across the
overlay.  The user may be hosting a desirable file or a component of one. It
may be the destination of a voice over P2P call.  If nothing else, then for
privacy, so that overlay peers cannot easily profile your communication habits.
There are many forms of NAT traversal, but many require a third party to assist
in notifying both peers to simultaneously communicate with each other.  Thus
the overlay must have some means of relaying communication between peers.  In
some cases, peers will not be able to form direct connections, in which case,
the overlay will need to provide relaying of arbitrary data in order for the
peers to communicate.

Thus to instantiate a private version of these large-scale P2P systems would
require the use of overlay-centric dedicated components and rely on out of band
mechanisms to relay this information to others, such as an e-mail or a phone
call.  Even if this is feasible, this sort of interaction is undesirable, P2P
systems should be self-discovering so that users need to do minimal amount of
work to take advantage of them and adhoc systems stress this point.  In
addition, these approaches rely on centralized components, thus if they become
unavailable, which is very likely since most users lack the expertise in
configuring highly available systems, the system will not be accessable.

To address this, we propose the use of existing public overlays as a means to
bootstrap into private overlays.  There are many existing wide-spread systems
with high availability, such as Skype, Gnutella, XMPP, and BitTorrent; by
leveraging these systems, system integrators can easily enable users to
seamlessly bootstrap their own private P2P systems.  In the preceding
paragraphs, we identified the components necessary for bootstrapping in a
homogeneous system, now we expand them for environments to support the
bootstrapping of a private overlay from a public overlay with consideration for
network constrained peers.  The public overlay must support the following
mechanisms:
\begin{enumerate}
\item \textbf{Reflection} - Constrained peers must have some method of
determining their Internet connection information, to share with other
constrained peers to enable direct connectivity.
\item \textbf{Rendezvous} - Peers seeking members of a private overlay in a
public overlay must be able to identify each other.
\item \textbf{Relaying} - Peers must be able to exchange arbitrary data to
share connection information and to enable direct links across NATs when
possible or, otherwise, as a relay.
\end{enumerate}
This work motivates from the belief that what prevents use of P2P systems is
due to lack the resources, technical knowledge, or desire to create and manage
high availability bootstrap services.  A public overlay can be used to
transparently bootstrap a private overlay with minimal user interaction.

These requirements will be presented and verified in the context of two
prototype implementations: a XMPP (Jabber)~\cite{xmpp} and
Brunet~\cite{brunet}.  XMPP or Extensible Messaging and Presence Protocol based
overlays are commonly used as chat portals, for example, GoogleTalk and
Facebook Chat use the protocol.  XMPP also supports a P2P overlay amongst
servers forming a XMPP Federation allowing inter-domain communication amongst
chat peers, so that users from one XMPP server can communicate with those using
another.  Brunet provides generic P2P abstractions as well as an implementation
of the Symphony structured overlay.  We present the architecture for these
systems, the lessons learned in constructing and evaluating them,  as well as
provide quantitative analysis of peer connectivity to a private Brunet overlay.

The organization of this paper follows.  Section~\ref{background} presents
common P2P overlay technologies, unstructured and structured P2P systems, NAT
challenges in P2P systems, and then an overview of existing bootstrapping
techniques.  In Section~\ref{our_contribution}, we present our contribution and
describe its relation to various existing public overlays.  Various
applications that can be enabled by this architecture are described in
Section~\ref{applications}.  Finally, we conclude the paper with
Section~\ref{conclusions}.

\section{Background}
\label{background}
\subsection{Common P2P Systems}

Large-scale P2P systems typically come in two flavors:  unstructured and
structured.  Unstructured systems~\cite{gnutella, fasttrack} are generally
constructed by peers attempting to maintain a certain amount of connections to
other peers in the P2P system, whereas structured systems organize into
well-defined topologies, such as 2-D rings or hypercubes.  Though unstructured
systems are typically simpler to bootstrap and maintain, they rely on global
knowledge, flooding, or stochastic techniques to search for information in an
overlay and thus creating potential scalability constraints.  Alternatively,
structured systems~\cite{pastry, chord, symphony, kademlia, can}.  have
guaranteed search time typically with a lower bound of $O(\log N)$, though
recent research has shown that these systems can be constructed to support
$O(1)$ search time~\cite{beehive}.  

A key component of most structured overlays is support for decentralized
storage / retrieval of information by mapping keys to specific node IDs in an
overlay called a distributed hash table (DHT).  At a minimum, the data is
stored at the node ID either smaller or larger to the data's node ID and for
fault tolerance the data can be stored at other nodes.  DHTs can be used by
peers of systems to coordinate allocation and discovery of resources, making
them attractive for self-configuration in decentralized collaborative
environments.  DHTs provide the building blocks to form more complex
distributed data stores as presented in Past~\cite{past} and
Kosha~\cite{kosha}.  While most publications of structured overlays focus on
their ability to scale from thousands to millions of nodes, practical
applications have employed them in the order of 10s to 100s of nodes.  For
example, Amazon's shopping cart runs on Dynamo~\cite{dynamo} using a ``couple
of hundred of nodes'' or less.  Facebook provides an inbox search system using
Cassandra~\cite{cassandra} running on ``600+ cores''.  As mentioned in the
publications, this is due to the high availability and autonomic features
provided by dedicated structured overlays.

Another subset found in various scale environments are ``P2P'' systems that are
not fully decentralized, such as ``P2P VPNs'' like Hamachi~\cite{hamachi},
older systems like the original Napster, and tracker-based BitTorrent.  These
types of systems provide a rendezvous services for peers to discover each other
to form direct, or P2P, connections with each other for the purpose of network
connectivity or data sharing.  BitTorrent differentiates itself by using the
trackers as a gateway into the overlay, once inside, peers exchange connection
information with each other directly relegating the tracker as a fall back.
This approach has enabled BitTorrent to be modified to support trackerless
torrents through using a DHT.

\subsection{Network Address Translation Hampering P2P Systems}

As of 2010, the majority of the Internet is connected via Internet Protocol
(IP) version 4.  A limitation in this protocol is that there are only $2^{32}$
addresses (approximately 4 billion) available.  With the Earth's population of
over 8 billion and each individual potentially having multiple devices that
have Internet connectivity, the IPv4 limitation is becoming more and more
apparent.  To address this issue there have been two approaches:  1) the use of
network address translation (NAT) to enable many machines and devices to share
a single IP address but preventing bidirectional connection initiation, and 2)
IPv6 which supports $2^{128}$ addresses.  The use of NATs complicates the
bootstrapping of P2P systems as it prevents peers from simply exchanging
addresses with each other to form connections, as the addresses may not be
public.  In addition, firewalls may prevent peers from receiving incoming
connections.  Thus while the eventual widespread use IPv6 will cause the demise
of NATs, though this is not guaranteed, it does not deal with the issue of
firewalls preventing P2P applications from communicating.

When a machine, \textit{A}, behind a typical NAT, \textit{B}, sends out a
packet to an Internet host, \textit{C}, the NAT device translates the packet so
that it appears it is coming from the NAT device making the NAT device a router.
When the the packet is sent from \textit{A} to \textit{C}, the source and
destination are listed as $IP:port$ pairs, where the source and destination are
$IP_A:Port_A$ and $IP_C:Port_C$, respectively.  \textit{A} forwards the packet
to \textit{B} who transforms the source from $IP_A:Port_A$ to $IP_B:Port_B$,
where $Port_A$ may or may not be equal to $Port_B$.  This creates a NAT mapping
so that incoming packets from $IP_C:Port_C$ to $IP_B:Port_B$ are translated and
forwarded to $IP_A:Port_A$.

There are a handful of recognized NAT devices as presented in~\cite{stun,
p2p_nats_rfc}.  The following list focuses on the more prevalent types:
\begin{itemize}
\item \textbf{Full cone} - All requests from the same internal IP and port are
mapped to a static external IP and port, thus any external host can communicate
with the internal host once a mapping has been made.
\item \textbf{Restricted cone} - Like a full cone, but it requires that the
internal host has sent a message to the external host before the NAT will pass
the packets.
\item \textbf{Port restricted cone} - Like a restricted cone, but it requires
that the internal host has sent the packet to the external hosts specific port,
before the NAT will pass packets.
\item \textbf{Symmetric} - Each source and destination pair have no relation,
thus only a machine receiving a message from an internal host can send a
message back.
\end{itemize}

Peers on cone NATs can easily be traversed so long as a third-party assists in
determining the port allocated by the NAT and as a medium for the peers to
exchange this information, this method is referred to as STUN~\cite{stun_rfc}.
Peers behind symmetric NATs cannot easily communicate with each other, since
there is no relation between remote hosts and ports and local ports.  Further
complicating the matter is that there are various types of symmetric NATs,
having behaviors similar to full, restricted, and port restricted cone NATs.
\cite{ice} describes methods to traverse these NATs so long as there is a
predictable pattern to port selection.  The approaches that attempt to form
direct connections between peers, hole punching, generally use UDP.  UDP,
unlike TCP, lacks state, thus traversal attempts do not need to be concerned
with potentially replaying message or handling potential reject methods that
may occur when attempting to perform TCP hole punching ,  though there is
reasonable amount of work describing TCP NAT traversal such as~\cite{tcp_nat}.
TCP NAT traversal is complicated by stateful firewalls, or those that watch
connections and connection attempts preventing messages from closed TCP
channels from passing through the NAT.  For situations in which both peers are
behind NATs and firewalls that prevent in bound communication inhibiting NAT
traversal, a third-party can act as a relay between the two, known as
triangulation or TURN~\cite{turn} (traversal using relay NAT).

These NAT traversal services in themselves only deal with a small portion of
the bootstrap problem, reflection.  That is, peers are able to obtain a public
address for receiving incoming connections.  These services provide no means
for users to exchange these addresses with each other and cannot make any
guarantees on how long the mappings will be valid.  Thus a peer using an
address that was not exchanged recently may find that there is no peer or a
completely different service is now listening on the remote end.  To address
this issue many systems incorporate these NAT traversal libraries and use
intermediaries to exchange addresses.  In order for peers to form direct
connectoins, peers still need a mechanism to discover each other or rendezvous
and then a relay pathway to exchange their network information.

An example of an application that uses these types of services combines with
rendezvous and relay is Teredo~\cite{teredo}.  Teredo enables all peers to have
a globally identifiable IPv6 address.  The IPv6 address maps to a specific
Teredo gateway, client pair.  When two peers using Teredo attempt to connect
with each other, the Teredo servers exchange the clients IP information
obtained using a STUN-like procedue.  While this gives users a public address,
it does not do so in a scalable or fault tolerant way.  If the Teredo gateway
goes offline or becomes saturated, the peers outgoing and incoming requests may
be ignored.

\subsection{Bootstrapping P2P Systems}

As described in the introduction, the simple case of bootstrapping is limited
to one peer attempting to find an active peer in the overlay in order for
itself to become a member.  The large-scale providers have resources not
readily available to small-scale overlays.  This section presents the existing
techniques and those being developed and describes their application to
small-scale systems.

When using dedicated bootstraps, a service provider hosts one or more bootstrap
resources.  Peers desiring to join the overlay query the bootstrap nodes, until
a successful connection is made to one.  The bootstrap server will then assist
in connecting to other nodes in the P2P system.  The bootstrap nodes are either
packaged with the application at distribution time or through a meta data file,
such as in BitTorrent.  In small, ad hoc pools, this approaches draw backs are
that the server would have to be used every time to bootstrap the system or
users would have to reconfigure their software to connect to the appropriate
bootstrap server.  A bootstrap server creates a single point of failure,
especially when not being deployed using high availability techniques.  This
approach requires at least one peer to have a publicly accessible address.

Another commonly used approach for large-scale systems is the use of a host
cache~\cite{host_cache}.  Clients post current connection information to
dedicated web services, a host cache, that cache the connection information and
URLs to other host caches.  For small, ad hoc networks, a host cache acts no
differently than a centralized rendezvous point, requiring that at least one
peer has a publicly accessible address.

Research has shown that peers using locality properties of IP addresses, a peer
can use intelligent random probing~\cite{bootstrapping_p2p, locality_aware} are
able to find an online peer in ``Gnutella-sized'' overlays.  The results show
for networks in the order of tens of thousands that a peer can find an active
peer node within 2,000 guesses.  The application of this approach to small, ad
hoc groups is challenging.  If peers are behind NATs, the port mapping may
change randomly or not be the same for multiple peers, further more, if peers
are widely distributed and very small, this approach may have to query the
majority of the IP address range to find a peer.

Rather then distribute an IP address, which points explicitly to some location
in the Internet, a small P2P network can apply a name abstraction around one
peer in the overlay using Dynamic DNS~\cite{bootstrapping_ddns}.  In this
approach, peers share a common DNS entry, providing a common means to bootstrap
the overlay.  When the peers detect that the IP directed to by the host is
offline, they use a random time back off algorithm to replace it.  The
application of this approach to small, ad hoc groups is actually quite nice, as
the service could be distributed across multiple Dynamic DNS registrations.
The significant drawback to the approach is that the dynamic DNS server could
be attacked, since the login information must be shared amongst all peers in
the overlay.  Also the approach requires that at least one peer be publicly
addressable and know that it is, if a non-publicly addressable peer updates the
cache, it could delay or permanently prevent peers from creating a P2P system.
The results were simulation based and did not determine how well a dynamic DNS
would cope with active constant changing of the name to IP mapping.

IP supports multicasting to groups interested in a common service.  In the case
of bootstrapping a P2P system~\cite{pastry, locality_aware}, all peers would be
members of a specific group.  When a new peer comes online, it would query this
group for connection information and then connect to those that respond.  The
drawback to this approach is that it only works in environments connected by IP
multicast, typically local area networks only, thus for a wide-area,
distributed P2P system, this approach will most likely not work.

A large-scale structured overlay~\cite{one_ring, p2p_bootstrap} could enable
peers to publish their information into a dedicated location for their service
or application and then query that list to obtain a list of online peers.
Peers could then come online, search for peers in their overlay, and then
connect with them using their connection information.  Since the service would
be a large-scale system, it could easily be bootstrapped by a dedicated
bootstrap or host caches.  As it stands, the described works were position
papers and the systems have not been fully fleshed out.  The primary challenge
in relationship to small, ad hoc networks is that it lacks details
bootstrapping of peers behind NATs into overlays as it provides only a means
for rendezvous and no reflection nor relaying.

\section{Bootstrapping Private Overlays}
\label{our_contribution}

As presented in the preceding sections, a solution to bootstrapping small P2P
overlays must address several challenges, namely reflection, rendezvous, and
relaying.  In this section, we present a generic solution to this problem.  At
the basis of our solution is the use of a publicly available free-to-join
public overlay.  In order to support these features the public overlay must
have mechanisms for peers to determine their network identity and maintain
these mappings, reflection; search for other peers that are bootstrapping the
same P2P service, rendezvous; and send messages to peers through the overlay,
relaying.

These are the minimum requirements to bootstrap a decentralized, P2P system
when all peers are behind NATs.  Without a reflection utility, two peers would
be unable to communicate directly with each other, when they exchange
connection information, they would only be able to share local networking
information.  If they are not on the same network, the information will be
useless.  Furthermore, if they are on the same network, then an approach using
multicast would be sufficient.  Thus assuming that the other two capabilities
are available, rendezvous and relaying, peers would only be able to communicate
through the overlay, which may introduce significant latency and bandwidth
overheads.  

A system, lacking the ability to exchange messages via the overlay or relaying,
could limit the types of NATs peers could traverse.  Assuming reflection and
rendezvous, a peer could obtain connection information for another peer through
an entry in the DHT, much like Tracker-less torrents, and connect to it so long
as the peer is either on a public address, behind a cone NAT, or have a TURN
connection, though a TURN connection would violate the expectation of the
overlay lacking relay capabilities.  In other all other NAT cases, a peer must
initiate simulataneous connection attempts in order to form a direct
connection.  Furthermore, while TURN may provide relaying, it is not very
scalable unless the features is built decentrally into the overlay.

Without rendezvous, peers would have no mechanisms to discover each other, in
this case, random probing would be the only mechanism for peers to discover
each other.  If the peers are behind NATs, not even random probing would be
sufficient for them to form connections with each other.  Thus rendezvous is
the most important component without it, peers would be unable to find each
other.

Table~\ref{tab:overlays} reviews various overlays, the majority of which are
public free-to-join overlays, though some research only overlays are included.
The overlays were chosen based upon their scale and availability.  From this
the most attractive two services are Brunet and XMPP.  Brunet provides
traditional P2P infrastructure, though lacks the large-scale and high
availability features due to being rooted in an academic project.  XMPP,
on the other hand, is a non-traditional overlay and limits private overlays
to being bootstrapped through friendship connections.  While most users
seeking a private overlay will do so with friends, this may not always be the
case, consider video game players searching for people to play with online.
On the other hand, XMPP is built on top of production systems thus has
more applicability to real world usage.

\begin{table*}[h!t!]
\centering
\begin{tabular}[c]{|m{1.5cm}||m{5.5cm}|m{3cm}|m{3cm}|m{3cm}|}
\hline & Description & Reflection & Rendezvous & Relay \\ \hline \hline
BitTorrent &
Basic BitTorrent systems rely on a centralized tracker to provide the initial
bootstrapping.  At which point, the peers no longer require use of the tracker,
but it can be used to monitor the state of the file distribution and ensure
good distribution of file providers, seeds.  BitTorrent specifies a protocol,
though each client may support additional features not covered by the protocol.
&
In general, the current specification does not support NAT traversal, though
future versions may potentially use UDP NAT traversal.  At which point,
BitTorrent may support a reflection service.
&
&
\\ \hline
Gnutella &
Gnutella is a large-scale unstructured overlay, consisting of over a million
active peers.  Gnutella's is primarily used for file sharing.  Skypes general
make up consists of a couple thousand super, ultra, peers to provide
reliability to the overlay.  Gnutella is free-to-join and requires no
registration to use.
&
Work in progress.  Peers attempt to connect to a sharers resource, though a
"Push" notification reverses this behavior.  Thus a peer behind a NAT can
share with a peer on a public address.
&
Peers can perform broadcast searches with TTL up to 2, when networks consist of
millions of peers, small overlays will most likely not be able to discover each
other.
&
Not explicitly, could potentially utilitize ping messages to exchange messages.
\\ \hline
Skype &
Skype is a large-scale unstructured overlay, consisting of over a million
active peers.  Skype is primarily used for voice over P2P communication.
Skype, like Gnutella, also has super peers, though the owners of Skype
provides authentication and bootstrap servers.  Though Skype is free-to-join,
it requires registration to use.
&
Skype APIs provide no means for reflection.
&
Skype allows extensions through applications.  It is possible for peers to
broadcast queries to each other, transparently from the user, to determine if
a given user has an application installed.  Thus Skype does support rendezvous.
&
Skype applications are allowed to route messages via the Skype overlay, but
because Skype lacks reflection, all communication must traverse the Skype
overlay.
\\ \hline
XMPP &
XMPP consists of a federation of distributed servers.  Peers must register
an account with server, though registration can be done through XMPP APIs
without user interaction.  XMPP is not a traditional P2P system, though it
has some P2P features.  XMPP servers allow peers on distinct XMPP servers
to communicate with each other.  The links between servers are created
based upon client demand.  The links are trusted due to a certificate
provided, when the server joins the XMPP federation.
&
While not provided by all XMPP servers, there exist extensions for NAT
traversal.  GoogleTalk, for example, provides both STUN and TURN servers.
&
Similar to Skype, XMPP friends can broadcast queries to each other to find
other peers using the same P2P service.  THus XMPP supports rendezvous.
&
The XMPP specification allows peers to exchange abitrary out of band
communication with each other.  Most servers support this behavior, even
when sent across the federation.  Thus XMPP supports relaying.
\\ \hline
Kademlia~\cite{kademlia} &
There exists two popular Kademlia systems, one used by many BitTorrent systems
and the other used by Gnutella, called Mojito.  Kademlia implements an
iterative structured overlays, where peers query each other directly when
searching the overlay.  Thus all resources of a Kademlia overlay must be
publicly addressable.
&
Existing implementations of Kademlia does not support mechanims for peers to
determine their network identity.
&
Peers can use the DHT as a rendezvous service, storing their connectivity
information in the DHT at key location:  $hash(SERVICE)$.
&
An iterative structured overlay has no support for relaying messages.
\\ \hline
OpenDHT~\cite{opendht} &
OpenDHT was until recently a freely available DHT running on PlanetLab, though
it was  recently decommissioned.  OpenDHT is built using Bamboo, a Pastry-like
protocol~\cite{pastry}.  Pastry implements recursive routing, where peers
in the overlay forward messages for each other from source to destination.
&
Existing implementations of Bamboo and Pastry do not support mechanims for
peers to determine their network identity.  Though this is ongoing work.
&
Peers can use the DHT as a rendezvous service, storing their connectivity
information in the DHT at key location:  $hash(SERVICE)$.
&
Because Pastry uses recursive routing, it can be used as a relay.  Furthermore,
extensions to Pastry have enabled explicit relays called virtual
connections~\cite{epost}.
\\ \hline
Brunet~\cite{brunet} &
Brunet like OpenDHT is a freely available DHT running on PlanetLab, though
still in active development.  Brunet creates a Symphony~\cite{symphony} overlay
using recursive routing.
&
Brunet supports inherent reflection services, when a peer forms a connection
with a remote peer, the peers exchange their view of the relationship.
&
Peers can use the DHT as a rendezvous service, storing their connectivity
information in the DHT at key location:  $hash(SERVICE)$.
&
Like Pastry, Brunet supports recursive routing and even supports explicit
relays called tunnels~\cite{hpdc08_0}.
\\ \hline
\end{tabular}
\caption{}
\label{tab:overlays}
\end{table*}

\subsection{Bootstrapping Private Overlays Using Brunet}
\subsection{Bootstrapping Private Overlays Using XMPP}

\section{Applications}
\label{applications}
In this section, we present applications and potential ways to configure them
to use a private overlay.  The applications we investigate include chat rooms,
social networks, VPNs, and multicast.  The key to all these applications is that
users can easily host their own services and be discovered through the use of
a free-to-join public overlay.

\subsection{Chat Rooms}
Chat rooms provide a platform for individuals with a common interest to find
each other, group discussion, private chat, and data exchange.  One of the most
popular chat systems for the Internet is Internet Relay Chat (IRC).  As
described in~\cite{irc}, IRC supports a distributed tree system, where clients
connect to a server, and servers use a mixture of unicast and multicast to
distribute messages.  The issues with IRC are documented by~\cite{irc_arch},
namely, scalability due to all servers needing global knowledge, reliability
due to connectivity issues between servers, and lack of privacy.  Private
overlays could be extended to support the features of IRC and potentially deal
with these inherent issues.  Each chat room would be mapped to a private
overlay and the public overlay would be used as a directory to learn about
available chat rooms and request access.  Structured overlays do not require
global knowledge and can be configured to handle connectivity issues.
Additionally, IRC by default uses clear text messaging and even if security is
used a server will be aware of the content of the message, two issues resolved
by using PtP security in a private overlay chat room.  

\subsection{Social Networks}
Social networks such as Facebook and MySpace provide an opportunity for users
to indirectly share information with friends, family, and peers via a profile
containing personal information, status updates, and pictures.  Most social
network structures rely on hosted systems, where they become the keepers of
user data, which creates privacy and trust concerns.  Private overlays can
remove this third party, making users the only owner of their data.  For this
model, we propose that each user's profile be represented by a private overlay
and that each of their friends become members of this overlay.  The overlay
will consist of a secured DHT, where only writes made by the overlay owner are
valid and only members of the overlay have access to the content stored in it.
In addition to bootstrapping the private overlays, the public overlay would be
used as a directory for users to find and befriend each other.  For fault
tolerance and scalability, each user provides a copy of their profile locally,
which will be distributed amongst the private overlay in a read-only DHT,
therefore, allowing the user's profile to be visible whether they are offline
or online.  Each user's social network would than consist of the accumulation
of the individual private overlays and the public overlay.

\subsection{P2P VPNs}
Private overlays enable P2P VPNs.  The most common type of VPNs are centralized
VPNs like OpenVPN, which requires that a centralized set of resources handle
session initialization and communication.  Another approach taken by Hamachi
and many others is to maintain a central server for session initialization but
allow communication to occur directly between peers and providing a central
relay when NAT traversal fails.  Using a structured private overlay allows
users to host their own VPNs, where each VPN end points is responsible for its
own session initialization and communication.  The private overlay also
provides mechanisms for handling failed NAT traversal attempts via relaying.

\subsection{Multicast}
The topic of secure multicast has been a focus of much research.  Using an
approach similar to CAN~\cite{can_multicast}, a virtual private overlay forms a
ring where all nodes are members of the multicast group with the additional
feature that you can trust that your audience is limited to those in the
overlay.  The main advantage of such multicasting technologies would be for
wide-area, distributed multicast.  Examples of such services include light
weight multicast DNS / DNS-SD (service discovery), as well as audio and video
streaming.

\section{Implementation Details and Evaluation}
\label{evaluations}
In this section, we describe our prototype implementation of a secure, private
overlay followed by evaluation to quantify network overheads.
\section{Conclusion}
\label{conclusions}
%\section*{Acknowledgment}

\bibliographystyle{IEEEtran}
\bibliography{VirtualPrivateOverlays}
\suppressfloats

\end{document}
